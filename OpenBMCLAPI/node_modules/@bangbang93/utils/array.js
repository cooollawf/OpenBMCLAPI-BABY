"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.generateSortFunction = exports.arraySort = void 0;
const is_1 = __importDefault(require("@sindresorhus/is"));
const lodash_1 = require("lodash");
function arraySort(arr, orderKey) {
    return arr.sort(generateSortFunction(orderKey));
}
exports.arraySort = arraySort;
function generateSortFunction(orderKey) {
    const keys = Object.keys(orderKey);
    const orders = (0, lodash_1.mapValues)(orderKey, (v) => {
        if (typeof v === 'string') {
            return {
                order: v[0],
                type: v.substr(1),
            };
        }
        else {
            return v;
        }
    });
    return (a, b) => {
        for (const key of keys) {
            const orderBy = orders[key];
            if (is_1.default.function_(orderBy)) {
                return orderBy(a, b);
            }
            else {
                const { order, type } = orderBy;
                const valueA = (0, lodash_1.get)(a, key);
                const valueB = (0, lodash_1.get)(b, key);
                if ((0, lodash_1.isNil)(a) || (0, lodash_1.isNil)(b)) {
                    return 0;
                }
                if (valueA !== valueB) {
                    switch (type) {
                        case 'string':
                            return valueA.localeCompare(valueB) * (order === '+' ? 1 : -1);
                        case 'number':
                            return (valueA - valueB) * (order === '+' ? 1 : -1);
                        case 'boolean':
                            return ((valueA ? 1 : 0) - (valueB ? 1 : 0)) * (order === '+' ? 1 : -1);
                        case 'date':
                            return (valueA.getTime() - valueB.getTime()) * (order === '+' ? 1 : -1);
                        default:
                            return 0;
                    }
                }
            }
        }
        return 0;
    };
}
exports.generateSortFunction = generateSortFunction;
//# sourceMappingURL=array.js.map